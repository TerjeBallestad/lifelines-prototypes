---
phase: 09.1-activity-difficulty
plan: 02
subsystem: ui-components
tags: [difficulty-ui, daisyui-rating, popover-api, activity-card, game-feedback]

# Dependency graph
requires:
  - phase: 09.1-01-difficulty-foundation
    provides: Activity difficulty calculation methods
  - phase: 09-action-resources
    provides: Native Popover API pattern from ActionResourcesSection
provides:
  - Visual difficulty star display on activity cards
  - Interactive tooltip showing difficulty breakdown
  - DifficultyStars reusable component
affects: [10-autonomous-decisions, activity-selection-ui]

# Tech tracking
tech-stack:
  added: []
  patterns: [daisyui-rating-readonly, native-popover-api-consistency]

key-files:
  created:
    - src/components/DifficultyStars.tsx
  modified:
    - src/data/activities.ts
    - src/components/ActivityCard.tsx

key-decisions:
  - "DaisyUI rating component with mask-star-2 for consistent star shapes (read-only mode using divs, not inputs)"
  - "Semantic color coding: bg-success (1-2 easy), bg-warning (2.5-3.5 medium), bg-error (4-5 hard)"
  - "Native Popover API for tooltips (consistency with ActionResourcesSection and MoodIcon patterns)"
  - "Backward compatible ActivityCard: works with or without character prop, shows base difficulty as fallback"

patterns-established:
  - "DifficultyStars component pattern: star display + optional breakdown prop for popover"
  - "Color-coded difficulty feedback: intuitive at-a-glance difficulty assessment"
  - "Graceful degradation in ActivityCard: Activity instance + character → personalized, ActivityData → base, missing → default 3 stars"

# Metrics
duration: 3min
completed: 2026-01-23
---

# Phase 9.1 Plan 02: Difficulty UI Display Summary

**Visual difficulty stars on activity cards with interactive breakdown tooltips using DaisyUI rating and native Popover API**

## Performance

- **Duration:** 3 min
- **Started:** 2026-01-23T18:19:50Z
- **Completed:** 2026-01-23T18:22:43Z
- **Tasks:** 3
- **Files modified:** 3 (1 created, 2 modified)

## Accomplishments

- Added baseDifficulty and skillRequirements to all 8 STARTER_ACTIVITIES
- Created DifficultyStars component using DaisyUI rating with mask-star-2 for star shapes
- Integrated difficulty display into ActivityCard header next to domain badge
- Color-coded difficulty: green (easy 1-2★), yellow (medium 2.5-3.5★), red (hard 4-5★)
- Interactive tooltip breakdown showing base difficulty, skill/mastery reductions, and per-skill contributions
- Native Popover API pattern matching ActionResourcesSection for consistency

## Task Commits

Each task was committed atomically:

1. **Task 1: Add Skill Requirements to Activities** - `2fe9058` (feat)
2. **Task 2: Create DifficultyStars Component** - `a80e1f6` (feat)
3. **Task 3: Integrate Difficulty into ActivityCard** - `7517839` (feat)

## Files Created/Modified

### Created
- `src/components/DifficultyStars.tsx` - Reusable star display component with optional popover breakdown

### Modified
- `src/data/activities.ts` - Added baseDifficulty (1-5) and skillRequirements arrays to all starter activities
- `src/components/ActivityCard.tsx` - Integrated DifficultyStars display in header, added optional character prop

## Decisions Made

**DaisyUI rating component for stars:**
- Chose `rating` container with `mask mask-star-2` divs for read-only display
- Divs (not inputs) ensure read-only behavior without form semantics
- Consistent with DaisyUI patterns while being semantically correct

**Semantic color scheme:**
- Easy (1-2★): `bg-success` (green) - approachable activities
- Medium (2.5-3.5★): `bg-warning` (yellow) - moderate challenge
- Hard (4-5★): `bg-error` (red) - difficult activities
- Unfilled stars: `bg-base-300` (muted neutral)
- Color communicated at-a-glance without requiring tooltip

**Native Popover API consistency:**
- Follows pattern established in ActionResourcesSection and MoodIcon
- Manual positioning to right of trigger
- mouseenter/mouseleave for show/hide
- Consistent `bg-neutral` styling with `shadow-lg`
- No DaisyUI tooltip conflicts (overflow/clipping issues resolved)

**Backward compatibility in ActivityCard:**
- Optional `character` prop for personalized difficulty
- Activity instance + character → effective difficulty with breakdown
- ActivityData with baseDifficulty → base difficulty, no breakdown
- Missing both → default 3 stars (medium)
- Enables progressive enhancement: works now, better with character context

## Skill Requirements Specification

**Social activities:**
- `chat-with-neighbor` (2★): small-talk (1.0, max 0.8), eye-contact (0.5, max 0.4)
- `phone-call-practice` (4★): phone-call (1.0, max 1.0), small-talk (0.5, max 0.5)

**Organisational activities:**
- `plan-tomorrow` (2★): make-list (1.0, max 0.8), follow-routine (0.3, max 0.3)
- `tidy-room` (3★): follow-routine (1.0, max 0.8), make-list (0.4, max 0.4)

**Physical activities:**
- `go-for-walk` (2★): go-outside (1.0, max 0.8), walk-neighborhood (0.5, max 0.5)
- `visit-store` (4★): go-to-store (1.0, max 1.0), go-outside (0.3, max 0.3), make-list (0.3, max 0.3)

**Restorative activities:**
- `rest` (1★): no skill requirements (anyone can rest)
- `solo-hobby` (2★): no skill requirements (creative domain, no skills yet)

**Pattern:** Harder activities (phone-call, visit-store) have higher baseDifficulty and more/higher skill requirements. Cross-domain activities (visit-store) require skills from multiple domains.

## Component API

**DifficultyStars component:**
```typescript
interface DifficultyStarsProps {
  difficulty: number;        // Effective difficulty (1-5 stars)
  breakdown?: DifficultyBreakdown; // Optional for tooltip
  size?: 'xs' | 'sm' | 'md'; // DaisyUI rating size
}
```

**ActivityCard character prop:**
```typescript
interface ActivityCardProps {
  // ... existing props
  character?: Character; // Optional for difficulty calculation
}
```

## Deviations from Plan

None - plan executed exactly as written.

## Success Criteria

- [x] Player can see 1-5 difficulty stars on each activity card
- [x] Stars use DaisyUI rating component (rating + mask mask-star-2)
- [x] Stars are color-coded by difficulty (bg-success/warning/error)
- [x] Hover tooltip shows base difficulty and modifier breakdown
- [x] Different patients see different effective difficulties for same activity (when character provided)
- [x] UI matches established patterns (native Popover API, DaisyUI rating)
- [x] TypeScript compiles without errors
- [x] Activities have baseDifficulty and skillRequirements
- [x] DifficultyStars component exists and renders colored stars
- [x] ActivityCard displays difficulty stars in all variants

## Next Phase Readiness

**Ready for Phase 9.1-03 (Difficulty verification):**
- Difficulty stars visible on activity cards
- Tooltip breakdown functional with native Popover API
- Color-coded difficulty provides immediate feedback
- Need visual verification of star rendering and popover positioning

**Enables Phase 10 (Autonomous Decisions):**
- Difficulty calculation available for AI decision-making
- Visual feedback established for player understanding
- Character skill progression now directly impacts activity difficulty perception

**No blockers identified.**
