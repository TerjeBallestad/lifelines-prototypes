---
phase: 02-character-core
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/entities/types.ts
  - src/utils/modifiers.ts
autonomous: true

must_haves:
  truths:
    - "Resources interface includes all 9 resource types"
    - "Modifier functions compute personality effects on drain/recovery"
    - "Modifier stacking is additive per CONTEXT.md decision"
  artifacts:
    - path: "src/entities/types.ts"
      provides: "Extended Resources interface with 9 fields"
      contains: "overskudd"
    - path: "src/utils/modifiers.ts"
      provides: "Modifier calculation utilities"
      exports: ["personalityToModifier", "combineModifiers", "applyModifiers"]
  key_links:
    - from: "src/utils/modifiers.ts"
      to: "src/entities/types.ts"
      via: "imports Resources type"
      pattern: "import.*Resources.*from.*types"
---

<objective>
Extend Resources interface from 3 to 9 types and create modifier calculation utilities.

Purpose: Establishes the expanded resource system and the mathematical foundation for personality-to-resource effects that will drive emergent behavior.

Output:
- Extended Resources interface with all 9 resource types
- defaultResources() factory returning valid defaults
- Modifier utility functions for computing personality effects
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-character-core/02-CONTEXT.md
@.planning/phases/02-character-core/02-RESEARCH.md
@src/entities/types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend Resources interface to 9 types</name>
  <files>src/entities/types.ts</files>
  <action>
Update the Resources interface to include all 9 resource types from CONTEXT.md:
- energy (existing)
- socialBattery (existing)
- stress (rename from stressLevel, 0=good, 100=bad)
- overskudd (Norwegian: surplus/headroom)
- mood
- motivation
- security
- focus (attention)
- nutrition (health)

Update defaultResources() factory:
- energy: 100 (full)
- socialBattery: 100 (full)
- stress: 0 (good = low)
- overskudd: 100 (full capacity)
- mood: 50 (neutral)
- motivation: 50 (neutral)
- security: 50 (neutral)
- focus: 100 (full)
- nutrition: 100 (full)

Also add ResourceKey type for type-safe access:
```typescript
export type ResourceKey = keyof Resources;
```
  </action>
  <verify>TypeScript compiles without errors: `npm run build`</verify>
  <done>Resources interface has 9 fields, defaultResources returns all 9 with appropriate defaults</done>
</task>

<task type="auto">
  <name>Task 2: Create modifier calculation utilities</name>
  <files>src/utils/modifiers.ts</files>
  <action>
Create src/utils/ directory and modifiers.ts with:

1. ResourceModifier interface:
```typescript
export interface ResourceModifier {
  resourceKey: ResourceKey;
  source: string;           // e.g., "low extraversion"
  drainModifier: number;    // -0.2 to +0.2
  recoveryModifier: number; // -0.2 to +0.2
}
```

2. personalityToModifier(traitValue: number): number
- Linear scaling per RESEARCH.md
- 0 = -0.20, 50 = 0, 100 = +0.20
- Formula: ((traitValue - 50) / 50) * 0.20

3. combineModifiers(modifiers: number[]): number
- Additive stacking per CONTEXT.md decision
- Sum all modifiers

4. applyModifiers(baseRate: number, modifiers: number[]): number
- Returns baseRate * (1 + combinedModifier)

5. clampResource(value: number, min = 0, max = 100): number
- Ensures resources stay within bounds (prevents negatives/overflow)

Export all functions and interfaces.
  </action>
  <verify>`npm run build` passes, no lint errors</verify>
  <done>modifiers.ts exists with all 5 exports, TypeScript compiles cleanly</done>
</task>

</tasks>

<verification>
- `npm run build` succeeds
- `npm run lint` passes
- Resources interface in types.ts has exactly 9 fields
- modifiers.ts exports: ResourceModifier, personalityToModifier, combineModifiers, applyModifiers, clampResource
</verification>

<success_criteria>
1. Resources interface extended from 3 to 9 types
2. defaultResources() returns all 9 with sensible defaults
3. Modifier utilities ready for Character class integration
4. All code compiles and lints cleanly
</success_criteria>

<output>
After completion, create `.planning/phases/02-character-core/02-01-SUMMARY.md`
</output>
